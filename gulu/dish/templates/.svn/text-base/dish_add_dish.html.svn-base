{% extends "restaurant_index_base.html" %}

{% load global_tags %}

{% block bodyclass %}menu_nav{% endblock %}
{% block index_base_class %}dish_add{% endblock %}

{% block profile_index_head %}
<div class="dish_menu_header tab_page_header">
    <div class="title cf">
        <h2 class="fleft">Create a Dish</h2>
        <div class="fright operate cf">
            <a class="btn3" href="{% slugurl restaurant restaurant-menu restaurant.id %}">Cancel</a>
        </div>
    </div>
    <div class="sp_hr_line"></div>
</div>

<div class="dish_edit_form">
    <form method="post" action="{% slugurl restaurant restaurant-add-dish restaurant.id %}">
        <script>
        function input_click_blur(e, default_v){
        	var now_v = e.val();
            e.val((now_v)?now_v:default_v);
            e.click(function(){
                var v = e.val();
                e.val((v==default_v)?'':v);
            })
            e.blur(function(){
                var v = e.val();
                e.val((!v)?default_v:v);
            })
        }
        $(document).ready(function(){
        	input_click_blur($('#id_name'), 'Dish Name');
        	input_click_blur($('#id_description'), 'Description');
        });
        </script>
        {% csrf_token %}
        <div class="cf">
            <p class="fleft f_name">
	            {{ form.name }}
            </p>
        </div>
        <div class="cf">
            <p class="fleft f_type cf">
                <span class="fleft">
                <label for="id_type">Type</label>
                {{ form.type }}
                </span>
                <a href="#" class="btn2 fleft">Add</a>
            </p>
            <p class="fleft f_price">
                <label for="id_price">價格</label>
                {{ form.price }}
            </p>
            <p class="fleft f_vip_price">
                <label for="id_vip_price">VIP價格</label>
                {{ form.vip_price }}
            </p>
            <p class="fleft f_reserve">
                {{ form.reserve }}
                <label for="id_reserve">開放網路訂餐</label>
            </p>
            {{ form.temp_photo }}
        </div>
        <div class="cf">
            <p class="f_description fleft">
                {{ form.description }}
            </p>
            <input class="btn_post" type="submit" name="submit" value="" />
        </div>
        
    </form>
</div>
{% endblock %}

{% block profile_index_body_left %}
<h3>Photos</h3>
<ul class="cf photo_select_radios">
    <li class="upload_photo">
        <input type="radio" name="cover_photo" id="id_cover_photo_upload">
        <label for="id_cover_photo_upload">我想上傳自己的照片</label>
        <div style="display:none;" class="display_upload_photo photo_item cf {% get_random photos_frame_l photos_frame_h photos_frame_r %}">
            <a href="#">
                <span class="photo_frame"></span>
                <div class="photo_item_bd">
                    <img id="img_placeholder" style="display: none;" />
                    <h5>{{ photo.title }}</h5>
                </div>
            </a>
        </div>
        <div id="img_error" style="color:red;"></div>
        <div class="upload_box">
            <div>
            <img src="{{ MEDIA_URL }}images/icon_upload_photo.png">
            </div>
            <input type="text" disabled value="upload photo"><div id="btn_browse" class="btn_browse"></div>
        </div>
    </li>
    {% for photo in photos %}
    <li class="dish_photos fleft">
        <div class="pick_one"><input type="radio" name="cover_photo" id="id_cover_photo_upload_{{ photo.id }}"></div>
        <label for="id_cover_photo_upload_{{ photo.id }}" class="photo_item cf {% get_random photos_frame_l photos_frame_h photos_frame_r %}">
			<a href="#">
			    <span class="photo_frame"></span>
			    <div class="photo_item_bd">
			        <img src="{{ photo.image190x125.url }}" />
			        <h5>{{ photo.title }}</h5>
			    </div>
			</a>
		</label>
	</li>
    {% endfor %}
</ul>
{% endblock %}

{% block profile_index_body_right %}
<h3>Dish Name</h3>
<div class="search"><input type="text" ></div>
<div class="dish_list">
    <ul>
    {% for dish in dishes %}
    <li class="{% cycle 'odd' 'even' %}">
        <input type="radio" name="dish_picker" id="dish_picker_{{ dish.id }}">
        <label for="dish_picker_{{ dish.id }}" >{{ dish.name }}</label>
    </li>
    {% endfor %}
    </ul>
</div>
{% endblock %}

{% block bottom_script %}
<script type="text/javascript" src="{{ MEDIA_URL }}js/lib/fileuploader.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}js/photos.js"></script>
<script>
$(document).ready(function() {
    var ajax_uploader = new Photos.AjaxUploader({
        button: $("#btn_browse"),
        imagespec: 'image190x125',
        errors: $("#img_error"),
        preview: $("#img_placeholder"),
        progress: $("#progress_percent"),
        input: $("#id_temp_photo"),
        url_input: $("#id_temp_photo_url"),
    });
});
</script>
{% endblock %}