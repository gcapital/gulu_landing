from django.conf.urls.defaults import *
from piston.resource import Resource
from piston.authentication import HttpBasicAuthentication, OAuthAuthentication
from piston.doc import documentation_view
from piston.emitters import Emitter, DjangoEmitter


from gulu.api.handlers import *
from gulu.api.event_handler import *
from gulu.api.user_handler import *
 

auth = HttpBasicAuthentication(realm="Test Realm")

"""gulu.api.handlers"""
dishes_rid = Resource(handler=get_dish_by_rid)
reviews_uid = Resource(handler=get_review_by_uid)
reviews_rid = Resource(handler=get_review_by_rid)
deals_rid = Resource(handler=get_deal_by_rid)
deals_nearby = Resource(handler=get_deal_nearby)
restaurants_nearby = Resource(handler=get_restaurant_nearby)
restaurant_rid = Resource(handler=get_restaurant_info)
"""gulu.api.event_handler"""
events_uid = Resource(handler=get_event_by_uid)
event_new = Resource(handler=create_event)
event_update = Resource(handler=update_event)
"""gulu.api.user_handler"""
user_uid = Resource(handler=get_user_info)
check_username = Resource(handler=signup_checkusername)
check_email = Resource(handler=signup_checkemail)
signup = Resource(handler=signup)
signin = Resource(handler=signin)


"""Default { 'emitter_format': 'json' }"""
urlpatterns = patterns('',
    url(r'^get_dish_by_rid', dishes_rid),
    url(r'^get_review_by_uid', reviews_uid),
    url(r'^get_review_by_rid', reviews_rid),    
    url(r'^get_deal_by_rid', deals_rid),
    url(r'^get_deal_nearby', deals_nearby),
    url(r'^get_restaurant_nearby', restaurants_nearby),
    url(r'^get_restaurant_info', restaurant_rid),
        
    url(r'^get_event_by_uid', events_uid),
    url(r'^create_event', event_new),
    url(r'^update_event', event_update),
    
    url(r'^get_user_info', user_uid),
    url(r'^signup_checkusername', check_username),
    url(r'^signup_checkemail', check_email),
    url(r'^signup_checkemail', check_email),
    url(r'^signin', signin),
    url(r'^signup', signup),
    
    # automated documentation
    url(r'^$', documentation_view),
)

#Authentication
urlpatterns += patterns(
    'piston.authentication',
    url(r'^oauth/request_token/$','oauth_request_token'),
    url(r'^oauth/authorize/$','oauth_user_auth'),
    url(r'^oauth/access_token/$','oauth_access_token'),
)
#Oauth Consumer
urlpatterns += patterns('',
    url(r'^oauth_ask_approve/(?P<site_name>.+)/$', 'api.oauth_consumer.oauth_ask_approve'),
    url(r'^oauth_handle_token/(?P<site_name>.+)/$', 'api.oauth_consumer.oauth_handle_token'),
)

#Twitter
urlpatterns += patterns(
    'api.twitter_api',
    url(r'^tweet_a_message/$', 'tweet_a_message'),
        
)

#Facebook
urlpatterns += patterns('api.facebook_api',
    url(r'^oauth_facebook_request', 'oauth_facebook_request'),
    url(r'^oauth_facebook_access', 'oauth_facebook_access'),    
)