{% extends "restaurant_base.html" %}

{% block bodyclass %}deal_nav{% endblock %}

{% load global_tags %}
{% block extrahead %}
<style>


</style>

<script type="text/javascript" src="{{ MEDIA_URL }}js/lib/jquery.alphanumeric.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}js/gulu.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}js/lib/fileuploader.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}js/photos.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}js/lib/jquery.ui.timepicker.js"></script>

<script type="text/javascript">
$(window).load(function() {
	// Initialize the date/time picker
	
	var start_time_picker = new Gulu.DateTimePicker({
		container: $(".start_datetime_picker"),
		input: $("#id_start_datetime"),
	});

	var end_time_picker = new Gulu.DateTimePicker({
		container: $(".end_datetime_picker"),
		input: $("#id_end_datetime"),
	});
});
</script>

{% endblock %}
{% block content %}

<div class="create_deal tab_page_header">
    <div class="title cf">
        <h2 class="fleft">Create Deal</h2>
        <div class="fright operate cf">
            <a class="btn3 fright"  href="{% slugurl restaurant deal-deals restaurant.id %}">Cancel</a>
        </div>
    </div>
    <div class="sp_hr_line"></div>
</div>

<div class="deals_form">
    <form class="cf" enctype="multipart/form-data" method="post" action="{% slugurl restaurant deal-add-deal restaurant.id %}">
		{% csrf_token %}
		{{ form.non_field_errors }}
        <div class="title">
            <label for="id_title">Title</label>
            {{ form.title }}
        </div>
        <div class="error_msg">
        	{{ form.title.errors }}
        </div>
        
        <div class="sp_hr_line"></div>
        
        <div class="deal_benefit cf">
            <h3>Deal Benefit</h3>
            <div class="dish fleft">
                <label for="id_dish">Dish</label>
                {{ form.dish }}
            </div>
            <div class="type fleft">
                <label for="id_type">type</label>
                {{ form.type }}
            </div>
            <div class="amount fleft">
                {{ form.amount }}
                <label for="id_amount">% Off</label>
            </div>
        </div>
        <div class="error_msg">
        	{{ form.dish.errors }}
        </div>
        <div class="error_msg">
        	{{ form.type.errors }}
        </div>
        <div class="error_msg">
        	{{ form.amount.errors }}
        </div>
        
        <div class="sp_hr_line"></div>
        
        <div class="deal_condition">
            <h3>Deal Condition</h3>
            <div class="people">
            </div>
            <div class="date">
                <input type="hidden" id="id_start_datetime" name="start_datetime">
                <input type="hidden" id="id_end_datetime" name="end_datetime">
                <div class="start_datetime_picker"></div>~
                <div class="end_datetime_picker"></div>
            </div>
            <div class="error_msg">
				{{ form.start_datetime.errors }}
			</div>
			<div class="error_msg">
				{{ form.end_datetime.errors }}
			</div>
            <div class="conditions">
                {{ form.conditions }}
            </div>
            <div class="error_msg">
				{{ form.conditions.errors }}
			</div>
            
            <div class="tool_box">
            	上傳圖片
            	{{ form.cover }}
            	<div id="btn_upload" class="upload_photo fleft"></div>
	            <div id="error_msg"></div>
	            <div id="img_placeholder" class="photo"></div>
	        </div>
	        <div class="error_msg">
	            {{ form.cover_id.errors }}
	        </div>
        </div>
        <div class="error_msg">
        	{{ form.conditions.errors }}
        </div>
        
        <div class="sp_hr_line"></div>
        
        <div class="">
            <h3>Place</h3>
            <div class="location_list">
			    <ul class="cf">
			    {% for location in other_locations %}
			        <li class=" deselect">
			        	<input class="restaurant_checked" type="checkbox" name="restaurants" value="{{ location.id }}">
			            <div class="info cf">
			                <div class="content fleft">
			                    <h3 class="entry_title">{{ location.name }}</h3>
							    <p class="address">{{ location.address }}</p>
							    <p class="tell">{{ location.phone }}</p>
			                </div>
			            </div>
			        </li>
			    {% endfor %}
			    </ul>
			</div>
        </div>
        <div class="sp_hr_line"></div>
        
        <div class="">
            <h3>Premium Features</h3>
            <div class="">
				Within 5 min walk mobile<br>
				Social<br>
				VIP<br>
				Favorite<br>
				Food Type<br>
				Gender<br>
				Location<br>
            </div>
            <div class="estimated_people">
				預估人數<br>
				<h3>0</h3>
            </div>
        </div>
        
        <div class="sp_hr_line"></div>
        
        <div class="">
            <h3>Pricing</h3>
            <div class="">
				設定預算<br>
				依折換次數(CPA)付費
            </div>
        </div>
        
        <div class="sp_hr_line"></div>
        
        <div class="">
            <h3>Payment</h3>
            <div class="">
				
            </div>
        </div>
        <div class="cf">
        	<input type="hidden" name="ongoing" value="True">
        	<input class="btn4 fleft" type="submit" name="submit" value="Cancel" />
        	<input class="btn4 fright" type="submit" name="submit" value="Create Deal" />
        </div>
    </form>
</div>


{% endblock %}
{% block bottom_script %}
<script type="text/javascript" src="{{ MEDIA_URL }}js/lib/fileuploader.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}js/photos.js"></script>
<script>
$(document).ready(function() {
    var ajax_uploader = new Photos.AjaxUploader({
        button: $("#btn_upload"),
        imagespec: 'image186x119',
        errors: $("#error_msg"),
        preview: $("#img_placeholder"),
        input: $("#id_cover_id"),
        url_input: $("#id_photo_url"),
    });
    
	$("li.deselect").click(function(){
		$(this).toggleClass("select");
		if ($(this).find('input').attr("checked")){
			$(this).find('input').attr("checked",false);
		}else{
			$(this).find('input').attr("checked","checked");
		}
	});
});
</script>
{% endblock %}